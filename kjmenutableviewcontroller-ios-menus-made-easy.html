<!DOCTYPE html>
<html lang="en">
<head>
      <title>Undefined Value</title>
    <meta charset="utf-8" />
    <link href="http://kristopherjohnson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Undefined Value Full Atom Feed" />
    <link href="http://kristopherjohnson.github.io/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="Undefined Value Categories Atom Feed" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="http://kristopherjohnson.github.io/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://kristopherjohnson.github.io/theme/css/skeleton.css" />
    <link rel="stylesheet" href="http://kristopherjohnson.github.io/theme/css/style.css" />
    <link rel="icon" type="image/png" href="images/favicon.png" />


    <meta name="tags" content="UITableViewController" />
    <meta name="tags" content="ios" />

</head>
<body id="index" class="home">
  <div class="container">

    <div class="row">
        <div class="logo">
            <a href="http://kristopherjohnson.github.io/">
                <img src="http://kristopherjohnson.github.io/theme/images/undefinedvalue_logo.png" alt="Logo">
            </a>
        </div>
        <header id="banner" class="body">
            <h1><a href="http://kristopherjohnson.github.io/">Undefined Value</a></h1>
            <strong>Kris Johnson's Blog</strong>
        </header><!-- /#banner -->
    </div>

    <div class="row">
        <nav id="menu"><ul>
            <li><a href="/">Front Page</a></li>
            <li><a href="/tags.html">Tags</a></li>
            <li><a href="/archives.html">Archives</a></li>
            <li><a href="http://kristopherjohnson.github.io/pages/about-me.html">About Me</a></li>
        </ul></nav><!-- /#menu -->
    </div><!-- /.row -->

    <div class="row">

        <div class="nine columns">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://kristopherjohnson.github.io/kjmenutableviewcontroller-ios-menus-made-easy.html" rel="bookmark"
         title="Permalink to KJMenuTableViewController - iOS Menus Made Easy">KJMenuTableViewController - iOS Menus Made Easy</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2011-07-31T21:22:17-04:00">
      Sun 31 July 2011
    </time>
    <ul class="tags">
        <li><a class="tag" href="http://kristopherjohnson.github.io/tag/uitableviewcontroller.html">UITableViewController</a></li>
        <li><a class="tag" href="http://kristopherjohnson.github.io/tag/ios.html">ios</a></li>
    </ul>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>I have a new open-source library on Github for use by iOS developers: <a href="https://github.com/kristopherjohnson/KJMenuTableViewController">KJMenuTableViewController</a>.</p>
<p>KJMenuTableViewController is an Xcode project that contains set of classes that simplifies the
creation of "menus" in iOS applications using <code>UITableViewController</code>.</p>
<p>The <code>UITableViewController</code> class is a generic mechanism for presenting a scrollable list of
rows of items.  It is powerful and extensible, but it can be a chore to present a simple
list of button-like objects that react when tapped.  One must provide implementations of several
methods of the <code>UITableViewDataSource</code> and <code>UITableViewDelegate</code> classes, each of which will
probably have a <code>case</code> statement to handle each of the individual items. It's not difficult, but it is
tedious and error-prone.</p>
<p>The KJMenuTableViewController classes simplify this usage case.  One simply defines a subclass of
<code>KJMenuTableViewController</code> and overrides the <code>viewDidLoad</code> method to create sections and row items.
<code>KJMenuTableViewController</code> implements the table view delegate and data source methods to
appropriately display the sections and rows, and will take action when a row is tapped.</p>
<p>The code to be executed when an item is tapped are written as a block.
When the block is invoked, a <code>KJMenuItemInvocation</code> structure is passed to it. This structure
contains pointers to the menu item, cell, and controller, so there is no reason for the block
to retain any of these objects itself.  (Beware of retain cycles if the block <em>does</em> reference
the menu item, cell, or controller.)
<!--break--></p>
<h2>Usage</h2>
<p>Someday, this will be a proper library, but right now the library is distributed as a demo
application that contains reusable classes.</p>
<p>To make use of the reusable classes, copy the following source files from the demo project into
your own application:</p>
<ul>
<li><code>KJMenuTableViewController.h</code> and <code>KJMenuTableViewController.m</code></li>
<li><code>KJMenuSection.h</code> and <code>KJMenuSection.m</code></li>
<li><code>KJMenuItem.h</code> and <code>KJMenuItem.m</code></li>
</ul>
<h2>Example</h2>
<p>In this example snippet, the controller is a subclass of <code>KJMenuTableViewController</code>, which is itself
a subclass of <code>UITableViewController</code>.  In the <code>viewDidLoad</code> method, we add a first section with
two items, each of which displays its text in an alert box, and a second section that has
an item that pushes a new controller onto the navigation stack.</p>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span> <span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>

    <span class="c1">// Add first section</span>

    <span class="n">KJMenuSection</span> <span class="o">*</span><span class="n">section</span> <span class="o">=</span> <span class="p">[</span><span class="n">KJMenuSection</span> <span class="nl">sectionWithHeaderTitle</span><span class="p">:</span><span class="s">@&quot;First Section&quot;</span><span class="p">];</span>
    <span class="n">section</span><span class="p">.</span><span class="n">footerTitle</span> <span class="o">=</span> <span class="s">@&quot;Select item above to display alert&quot;</span><span class="p">;</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">addSection</span><span class="p">:</span><span class="n">section</span><span class="p">];</span>

    <span class="n">KJMenuItem</span> <span class="o">*</span><span class="n">item</span><span class="p">;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">KJMenuItem</span> <span class="nl">itemWithTitle</span><span class="p">:</span><span class="s">@&quot;First&quot;</span><span class="p">];</span>
    <span class="n">item</span><span class="p">.</span><span class="n">detailText</span> <span class="o">=</span> <span class="s">@&quot;This is the first item&quot;</span><span class="p">;</span>
    <span class="n">item</span><span class="p">.</span><span class="n">block</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="n">KJMenuItemInvocation</span> <span class="n">inv</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">RootViewController</span> <span class="o">*</span><span class="n">controller</span> <span class="o">=</span> <span class="p">(</span><span class="n">RootViewController</span> <span class="o">*</span><span class="p">)</span><span class="n">inv</span><span class="p">.</span><span class="n">controller</span><span class="p">;</span>
        <span class="bp">NSString</span> <span class="o">*</span><span class="n">title</span> <span class="o">=</span> <span class="n">inv</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">titleText</span><span class="p">;</span>
        <span class="bp">NSString</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="n">inv</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">detailText</span><span class="p">;</span>
        <span class="p">[</span><span class="n">controller</span> <span class="nl">displayAlertWithTitle</span><span class="p">:</span><span class="n">title</span> <span class="nl">message</span><span class="p">:</span><span class="n">message</span><span class="p">];</span>
    <span class="p">};</span>
    <span class="p">[</span><span class="n">section</span> <span class="nl">addItem</span><span class="p">:</span><span class="n">item</span><span class="p">];</span>

    <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">KJMenuItem</span> <span class="nl">itemWithTitle</span><span class="p">:</span><span class="s">@&quot;Second&quot;</span><span class="p">];</span>
    <span class="n">item</span><span class="p">.</span><span class="n">detailText</span> <span class="o">=</span> <span class="s">@&quot;This is the second item&quot;</span><span class="p">;</span>
    <span class="n">item</span><span class="p">.</span><span class="n">block</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="n">KJMenuItemInvocation</span> <span class="n">inv</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">RootViewController</span> <span class="o">*</span><span class="n">controller</span> <span class="o">=</span> <span class="p">(</span><span class="n">RootViewController</span> <span class="o">*</span><span class="p">)</span><span class="n">inv</span><span class="p">.</span><span class="n">controller</span><span class="p">;</span>
        <span class="bp">NSString</span> <span class="o">*</span><span class="n">title</span> <span class="o">=</span> <span class="n">inv</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">titleText</span><span class="p">;</span>
        <span class="bp">NSString</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="n">inv</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">detailText</span><span class="p">;</span>
        <span class="p">[</span><span class="n">controller</span> <span class="nl">displayAlertWithTitle</span><span class="p">:</span><span class="n">title</span> <span class="nl">message</span><span class="p">:</span><span class="n">message</span><span class="p">];</span>
    <span class="p">};</span>
    <span class="p">[</span><span class="n">section</span> <span class="nl">addItem</span><span class="p">:</span><span class="n">item</span><span class="p">];</span>

    <span class="c1">// Add second section</span>

    <span class="n">section</span> <span class="o">=</span> <span class="p">[</span><span class="n">KJMenuSection</span> <span class="nl">sectionWithHeaderTitle</span><span class="p">:</span><span class="s">@&quot;Second Section&quot;</span><span class="p">];</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">addSection</span><span class="p">:</span><span class="n">section</span><span class="p">];</span>

    <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">KJMenuItem</span> <span class="nl">itemWithTitle</span><span class="p">:</span><span class="s">@&quot;Push view&quot;</span>
                       <span class="nl">accessoryType</span><span class="p">:</span><span class="n">UITableViewCellAccessoryDisclosureIndicator</span><span class="p">];</span>
    <span class="n">item</span><span class="p">.</span><span class="n">autoDeselectAfterSelect</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="n">item</span><span class="p">.</span><span class="n">block</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="n">KJMenuItemInvocation</span> <span class="n">inv</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">MyViewController</span> <span class="o">*</span><span class="n">subcontroller</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MyViewController</span> <span class="n">alloc</span><span class="p">]</span>
                                           <span class="nl">initWithNibName</span><span class="p">:</span><span class="s">@&quot;MyViewController&quot;</span> <span class="nl">bundle</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
        <span class="p">[</span><span class="n">inv</span><span class="p">.</span><span class="n">controller</span><span class="p">.</span><span class="n">navigationController</span> <span class="nl">pushViewController</span><span class="p">:</span><span class="n">subcontroller</span> <span class="nl">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
    <span class="p">};</span>
    <span class="p">[</span><span class="n">section</span> <span class="nl">addItem</span><span class="p">:</span><span class="n">item</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>


<p>For a complete example, see the demo application's <a href="https://github.com/kristopherjohnson/KJMenuTableViewController/blob/master/KJMenuTableViewController/RootViewController.m">RootViewController.m</a>.</p>
<h2>Future Directions</h2>
<p>The following features are planned:</p>
<ul>
<li>Add convenience methods to reduce the verbosity of setting up a menu.</li>
<li>Make it possible to add/remove menu items and change their attributes after menu has already been displayed. (As-is, you need to call the table view's <code>reloadData</code> method if you change anything after <code>viewDidLoad</code>.)</li>
<li>Provide a mechanism so that only one item within a section has a checkmark, and when user selects another item the originally checked item is unchecked.</li>
<li>Provide the ability to define a menu hierarchy that is handled by a single view controller.</li>
<li>Add support for compilation with ARC enabled</li>
</ul>
  </div><!-- /.entry-content -->
</section>
        </div><!-- /.nine columns -->

        <div class="three columns">
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>Other Stuff</h2>
                        <ul>
                            <li><a href="http://undefinedvalue.com/page/kjresume">Kris's Résumé</a></li>
                            <li><a href="http://secretspacelab.com/tcm.html">What's Good on TCM?</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>More of Me</h2>
                        <ul>
                            <li><a href="http://kristopherjohnson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="http://twitter.com/OldManKris">Twitter</a></li>
                            <li><a href="https://github.com/kristopherjohnson">GitHub</a></li>
                            <li><a href="http://stackoverflow.com/users/1175/kristopher-johnson">Stack Overflow</a></li>
                            <li><a href="https://pinboard.in/u:OldManKris">Pinboard</a></li>
                            <li><a href="http://www.linkedin.com/in/kristopherdjohnson">LinkedIn</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->
        </div><!-- /.three columns -->
    </div><!-- /.row -->

    <div class="row">
        <footer id="contentinfo" class="body">
            © 2003-2017 Kristopher Johnson
        </footer><!-- /#contentinfo -->
    </div><!-- /.row -->

  </div><!-- /.container -->
</body>
</html>
