<!DOCTYPE html>
<html lang="en">
<head>
      <title>My First AppleScripts | Undefined Value</title>
    <meta charset="utf-8" />
    <link href="http://undefinedvalue.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Undefined Value Full Atom Feed" />
    <link href="http://undefinedvalue.com/atom.xml" type="application/atom+xml" rel="alternate" title="Undefined Value Atom Feed" />
    <link href="http://undefinedvalue.com/rss.xml" type="application/rss+xml" rel="alternate" title="Undefined Value RSS Feed" />
    <link href="http://undefinedvalue.com/feeds/2004.atom.xml" type="application/atom+xml" rel="alternate" title="Undefined Value Categories Atom Feed" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="//fonts.googleapis.com/css?family=Oswald%7CLato%7CInconsolata" rel="stylesheet">
    <link rel="stylesheet" href="http://undefinedvalue.com/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://undefinedvalue.com/theme/css/skeleton.css" />
    <link rel="stylesheet" href="http://undefinedvalue.com/theme/css/highlight.css" />
    <link rel="stylesheet" href="http://undefinedvalue.com/theme/css/style.css" />
    <link rel="icon" type="image/png" href="images/favicon.png" />

    <meta name="tags" content="applescript" />
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-43697246-1', 'auto');
        ga('send', 'pageview');
    </script>
</head>
<body id="index" class="home">
  <div class="container">

    <div class="row">
        <div class="logo">
            <a href="http://undefinedvalue.com/">
                <img src="http://undefinedvalue.com/theme/images/undefinedvalue_logo.png" alt="Logo">
            </a>
        </div><!-- /.logo -->
        <header id="banner" class="body">
            <h1><a href="http://undefinedvalue.com/">Undefined Value</a></h1>
            <strong>Kris Johnson's Blog</strong>
        </header><!-- /#banner -->
    </div><!-- /.row -->

    <div class="row">
        <nav id="menu"><ul>
            <li><a href="/">Front Page</a></li>
            <li><a href="/tags.html">Tags</a></li>
            <li><a href="/archives.html">Archives</a></li>
            <li><a href="http://undefinedvalue.com/pages/about-me.html">About Me</a></li>
            <li><a href="http://undefinedvalue.com/pages/kjresume.html">My Résumé</a></li>
          <li><a href="http://undefinedvalue.com/search.html">Search</a></li>
        </ul></nav><!-- /#menu -->
    </div><!-- /.row -->

    <div class="row">

        <div class="nine columns">

<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://undefinedvalue.com/my-first-applescripts.html" rel="bookmark"
         title="Permalink to My First AppleScripts">My First AppleScripts</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2004-11-11T06:07:00-05:00">
      2004-11-11
    </time>
    <ul class="tags">
        <li><a class="tag" href="http://undefinedvalue.com/tag/applescript.html">applescript</a></li>
    </ul>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>OK, they aren't really my first AppleScripts. I used AppleScript a lot
back in the Mac OS 7 days, but unfortunately most of the applications I
used back then didn't support it very well. I was hoping things would be
better now, but they really aren't. Apple's applications have reasonable
support, but many third parties' applications do not.</p>
<p>Case in point: Mozilla Firefox 1.0. Released this week, I read several
Mac users' comments that we finally have a good browser for Mac OS. On
Windows, I prefer Firefox to IE, but on Mac, it is not as good as
OmniWeb, and is not better than Safari. What really bugs me about
Firefox is the lack of support for basic Mac features, especially
AppleScript.</p>
<p>But anyway, I found a need for a simple AppleScript today. I use
<a href="http://www.shrook.com">Shrook</a> as my RSS reader. Shrook is nice, but is
still not very polished. I was trying to download Adam Curry's <a href="http://www.dailysourcecode.com">Daily Source Code</a> MP3 from the Shrook window,
but the "Download Linked File" item on the context menu had no effect.
So I opened the page in OmniWeb, but OmniWeb wanted to download the
whole file and then play it in an ugly embedded QuickTime viewer. What I
really wanted to do was get iTunes to stream it, but didn't want to go
through all the hoo-hah of opening the URL in iTunes.</p>
<p>I haven't used AppleScript for years, so I spent a long while looking at
various examples on the web and experimenting with different concepts. I
finally came up with a script that would let me copy the MP3 URL to the
clipboard, and then select "Open Clipboard Location in iTunes" from my
Script Menu. Here's the script, which I saved as "Open Clipboard
Location in iTunes.scpt" in <code>~/Library/Scripts</code>:</p>
<div class="highlight"><pre><span></span><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;iTunes&quot;</span>  <span class="k">set</span> <span class="nv">theLocation</span> <span class="k">to</span> <span class="p">(</span><span class="nb">the clipboard</span> <span class="k">as </span><span class="nc">text</span><span class="p">)</span>  <span class="nb">open location</span> <span class="nv">theLocationend</span> <span class="k">tell</span>
</pre></div>


<p>Very simple, like it should be.</p>
<p>After that little exercise, I decided I'd like a similar script that
would open a URL from the clipboard in a new tab in OmniWeb. OmniWeb has
the richest AppleScript support of all the Mac browsers I've seen.
Here's the script:</p>
<div class="highlight"><pre><span></span><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;OmniWeb&quot;</span>
    <span class="nb">activate</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span> <span class="nb">browsers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">then</span>
        <span class="nb">make</span> <span class="nb">new</span> <span class="nb">browser</span> <span class="nb">at</span> <span class="nb">front of</span> <span class="nb">browsers</span>
    <span class="k">end</span> <span class="k">if</span>
    <span class="k">set</span> <span class="nv">theUrl</span> <span class="k">to</span> <span class="p">(</span><span class="nb">the clipboard</span> <span class="k">as </span><span class="nc">text</span><span class="p">)</span>
    <span class="k">tell</span> <span class="nb">front</span> <span class="nb">browser</span>
        <span class="k">set</span> <span class="nv">theNewTab</span> <span class="k">to</span> <span class="p">(</span><span class="nb">make</span> <span class="nb">new</span> <span class="no">tab</span> <span class="nb">at</span> <span class="k">end</span> <span class="k">of</span> <span class="nv">tabs</span> <span class="nv">with</span> <span class="na">properties</span> <span class="p">{</span><span class="nv">address</span><span class="p">:</span><span class="nv">theUrl</span><span class="p">})</span>
        <span class="k">set</span> <span class="na">active</span> <span class="no">tab</span> <span class="k">to</span> <span class="nv">theNewTab</span>
    <span class="k">end</span> <span class="k">tell</span>
<span class="k">end</span> <span class="k">tell</span>
</pre></div>
  </div><!-- /.entry-content -->
</section>
<ul>
    <li>Previous article: 
        <a href="http://undefinedvalue.com/name-taken.html">
            Name Taken
        </a>
    </li>
    <li>Next article:
        <a href="http://undefinedvalue.com/no.html">
            No
        </a>
    </li>
</ul>


        </div><!-- /.nine columns -->

        <div class="three columns">
        <section id="extras" class="body">
            <div class="recent">
                <h2>Recent Posts</h2>
                <ul>
                    <li><a href="http://undefinedvalue.com/adding-a-jinja2-filter-with-a-pelican-plugin.html">Adding a Jinja2 Filter with a Pelican Plugin</a></li>
                    <li><a href="http://undefinedvalue.com/re-cloudifying.html">Re-Cloudifying</a></li>
                    <li><a href="http://undefinedvalue.com/achievement-unlocked-colonoscopy.html">Achievement Unlocked: Colonoscopy</a></li>
                    <li><a href="http://undefinedvalue.com/simple-nsmachport-example.html">Simple NSMachPort Example</a></li>
                    <li><a href="http://undefinedvalue.com/rebuilding-my-blog-again.html">Rebuilding My Blog Again, with Pelican</a></li>
                </ul>
            </div><!-- ./recent -->
            <div class="blogroll">
                    <h2>Other Stuff</h2>
                    <ul>
                        <li><a href="http://secretspacelab.com/tcm.html">What's Good on TCM?</a></li>
                        <li><a href="https://github.com/kristopherjohnson">GitHub</a></li>
                        <li><a href="https://bitbucket.org/KristopherJohnson/">Bitbucket</a></li>
                    </ul>
            </div><!-- /.blogroll -->
            <div class="social">
                    <h2>Follow</h2>
                    <ul>
                        <li><a href="http://undefinedvalue.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>

                        <li><a href="http://twitter.com/OldManKris">Twitter</a></li>
                        <li><a href="http://stackoverflow.com/users/1175/kristopher-johnson">Stack Overflow</a></li>
                        <li><a href="https://pinboard.in/u:OldManKris">Pinboard</a></li>
                        <li><a href="https://www.flickr.com/photos/kristopherjohnson/">Flickr</a></li>
                        <li><a href="http://www.linkedin.com/in/kristopherdjohnson">LinkedIn</a></li>
                    </ul>
            </div><!-- /.social -->
        </section><!-- /#extras -->

        </div><!-- /.three columns -->
    </div><!-- /.row -->

    <div class="row">
        <footer id="contentinfo" class="body">
            © 2003-2017 Kristopher Johnson
        </footer><!-- /#contentinfo -->
    </div><!-- /.row -->

  </div><!-- /.container -->

<div class="footer-ad">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-format="fluid"
     data-ad-layout="in-article"
     data-ad-client="ca-pub-2819149266595616"
     data-ad-slot="4700820083"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div><!-- /.footer-ad -->
</body>
</html>
